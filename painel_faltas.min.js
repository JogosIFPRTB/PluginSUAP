javascript:(function(){const e=document.getElementById("painelFaltasResumo");e&&e.remove();const t={LIMITE:"#fa5252",ALERTA:"#ffd43b",PADRAO_BOTAO:"#5c9ded"},o=Array.from(document.querySelectorAll(".list-item dt")).find(e=>"Aulas Ministradas"===e.textContent.trim()),l=o?parseInt(o.nextElementSibling.textContent.trim().split(" de ")[0]):0;if(0===l)return void alert("NÃ£o foi possÃ­vel determinar o 'Total de Aulas Ministradas' a partir da pÃ¡gina. O script nÃ£o pode continuar.");const a=Array.from(document.querySelectorAll(".list-item dt")).find(e=>"Curso"===e.textContent.trim()),n=a?a.nextElementSibling.textContent.trim().split(" - ")[1]:"",r=n.replace(/\s*\(Campus.*?\)/i,"").trim(),s=document.querySelector(".title-container h2"),c=s?s.textContent.trim().split(" - ")[2]:"",i=Array.from(document.querySelectorAll(".list-item dt")).find(e=>"Professores"===e.textContent.trim()),d=i?i.nextElementSibling.textContent.trim().split(" (")[0]:"",u=[],m=[];document.querySelectorAll("#table_faltas tbody tr").forEach(e=>{const o=e.querySelector("td a[href*='/edu/aluno/']");if(!o)return;const a=o.textContent.trim(),n=e.querySelectorAll("input[type='text']");let r=0;n.forEach(e=>{const t=parseInt(e.value,10);isNaN(t)||(r+=t,t>0&&(e.style.backgroundColor="#ffe8e8",e.style.color="#c92a2a",e.style.fontWeight="bold"))});let s=0;const c=e.querySelector("td.text-start span.status");if(c){const e=c.textContent.match(/(\d+)\s+falta/);e&&(s=parseInt(e[1],10))}const i=Math.max(r,s);if(0===i)return;const d=(100*(1-i/l)).toFixed(2),p={nome:a,total:i,frequencia:d,cor:"white"},f=.25*l,g=f>2?f-2:f-1;i>f?(e.style.border=`2px solid ${t.LIMITE}`,p.cor=t.LIMITE,m.push(p)):i>g&&(e.style.border=`2px solid ${t.ALERTA}`,p.cor=t.ALERTA,m.push(p)),u.push(p)}),u.sort((e,t)=>t.total-e.total),m.sort((e,t)=>t.total-e.total);const p=document.createElement("div");p.id="painelFaltasResumo",p.style="position:fixed; top:10px; right:10px; z-index:9999; background:#1e1e1e; color:white; border:1px solid #555; border-radius:8px; padding:15px; width:380px; max-height:95vh; overflow-y:auto; font-family: Arial, sans-serif; box-shadow: 0 4px 15px rgba(0,0,0,0.5);",p.innerHTML=`<h3 style='margin-top:0; margin-bottom:10px;'>ðŸ“‹ Resumo de Faltas<br><small style="font-weight:normal; color:#ccc;">${r} - ${c}</small></h3>`,p.innerHTML+=`<p style="margin:0 0 10px 0; font-size:12px; color:#ccc;">Total de Aulas: ${l} | Limite de Faltas (25%): ${(.25*l).toFixed(0)}</p>`,0===u.length?p.innerHTML+=`<p style="color:${t.ALERTA};">Nenhum aluno com faltas registradas.</p>`:(()=>{let e=`Resumo de faltas da disciplina\n${c}\n${r}\n(Total de aulas: ${l})\n\n`;const o=document.createElement("ul");o.style.paddingLeft="20px",o.style.margin="0",u.forEach(e=>{const t=document.createElement("li");t.style.color=e.cor,t.style.marginBottom="5px",t.textContent=`${e.nome} - ${e.total} faltas (${e.frequencia}%)`,o.appendChild(t)}),e+=o.innerText,p.appendChild(o);const a=document.createElement("div");a.style.marginTop="15px",a.style.borderTop="1px solid #444",a.style.paddingTop="10px";const n=document.createElement("button");n.textContent="ðŸ“‹ Copiar Resumo",n.style=`padding:8px 12px; border:none; border-radius:5px; background-color:${t.PADRAO_BOTAO}; color:#fff; cursor:pointer;`,n.onclick=()=>{navigator.clipboard.writeText(e).then(()=>{n.textContent="âœ… Copiado!",setTimeout(()=>{n.textContent="ðŸ“‹ Copiar Resumo"},2e3)})},a.appendChild(n),m.length>0&&(()=>{const e=document.createElement("button");e.textContent="ðŸ“¨ Enviar SEPAE",e.style="margin-left:10px; padding:8px 12px; border:none; border-radius:5px; background-color:#28a745; color:#fff; cursor:pointer;",e.onclick=()=>{const e=encodeURIComponent(`Alunos com baixa frequÃªncia ou em risco - ${c}`),t=encodeURIComponent(`Prezados,\n\nSegue a lista de alunos da disciplina ${c}, curso ${r}, que estÃ£o com baixa frequÃªncia ou em situaÃ§Ã£o de alerta (prÃ³ximos ao limite de 25% de faltas):\n\n`+m.map(e=>`- ${e.nome}: ${e.total} faltas (${e.frequencia}% de frequÃªncia)`).join("\n")+`\n\nAtenciosamente,\n${d}`),o=`https://mail.google.com/mail/?view=cm&fs=1&to=sepae.tb@ifpr.edu.br&su=${e}&body=${t}`;window.open(o,"_blank")},a.appendChild(e)})(),p.appendChild(a)})();const f=document.createElement("button");f.textContent="âŒ",f.style="position:absolute; top:5px; right:8px; background:transparent; color:#aaa; border:none; font-size:18px; cursor:pointer;",f.onmouseover=()=>{f.style.color="white"},f.onmouseout=()=>{f.style.color="#aaa"},f.onclick=()=>p.remove(),p.appendChild(f),document.body.appendChild(p)})();
