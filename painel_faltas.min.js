javascript:(function(){const e=document.getElementById("painelFaltasResumo");e&&e.remove();const t=Array.from(document.querySelectorAll(".list-item dt")).find(e=>"Aulas Ministradas"===e.textContent.trim()),a=t?parseInt(t.nextElementSibling.textContent.trim().split(" de ")[0]):0,n=.25*a,l=n-2,o=Array.from(document.querySelectorAll(".list-item dt")).find(e=>"Curso"===e.textContent.trim()),r=o?o.nextElementSibling.textContent.trim().split(" - ")[1]:"",c=r.replace(/\s*\(Campus.*?\)/i,"").trim(),i=document.querySelector(".title-container h2"),s=i?i.textContent.trim().split(" - ")[2]:"",d=Array.from(document.querySelectorAll(".list-item dt")).find(e=>"Professores"===e.textContent.trim()),m=d?d.nextElementSibling.textContent.trim().split(" (")[0]:"",u=[],p=[],f=document.querySelectorAll("#table_faltas tbody tr");f.forEach(e=>{const t=e.querySelector("td a[href*='/edu/aluno/']"),o=t?t.textContent.trim():"Aluno não identificado",r=e.querySelectorAll("input[type='text']");let i=0;r.forEach(e=>{const t=parseInt(e.value);!isNaN(t)&&(i+=t,t>0&&(e.style.backgroundColor="#ffcccc"))});let d=0,h=e.querySelector("td.text-start span.status");if(h){const e=h.textContent.match(/(\d+)\s+falta/);e&&(d=parseInt(e[1]))}const g=Math.max(i,d),y=a>0?((1-g/a)*100).toFixed(2):"0.00";let b="white";g>n?(e.style.border="2px solid red",b="red",p.push({nome:o,total:g,frequencia:y})):g>l&&(e.style.border="2px solid orange",b="orange"),g>0&&u.push({nome:o,total:g,frequencia:y,cor:b})});const h=document.createElement("div");h.id="painelFaltasResumo",h.style="position:fixed;top:10px;right:10px;z-index:9999;background:#000;border:2px solid #000;border-radius:8px;padding:12px;width:380px;max-height:90vh;overflow-y:auto;color:white;font-family:Arial,sans-serif",h.innerHTML="<h3 style='margin-top:0;'>📋 Resumo de Faltas<br><small>"+c+" - "+s+"</small></h3>";let g="Resumo de faltas da disciplina\n"+s+"\n"+c+"\n(total de aulas: "+a+")\n";const y=document.createElement("ul");y.style.paddingLeft="20px",u.forEach((e,t)=>{const a=document.createElement("li");a.textContent=e.nome+" - "+e.total+" faltas - "+e.frequencia+"%",a.style.color=e.cor,y.appendChild(a),g+=t+1+". "+e.nome+" - "+e.total+" faltas - "+e.frequencia+"%\n"}),h.appendChild(y);const b=document.createElement("button");b.textContent="📋 Copiar",b.style="margin-top:10px;padding:6px 10px;border:none;border-radius:5px;background-color:#0066cc;color:#fff;cursor:pointer",b.onclick=()=>{navigator.clipboard.writeText(g).then(()=>{b.textContent="✅ Copiado!",setTimeout(()=>b.textContent="📋 Copiar",2e3)})},h.appendChild(b);const v=document.createElement("button");v.textContent="📨 Enviar SEPAE",v.style="margin-top:10px;margin-left:10px;padding:6px 10px;background:#28a745;color:#fff;border:none;border-radius:5px;cursor:pointer",v.onclick=()=>{const e=encodeURIComponent("Alunos com baixa frequência"),t=encodeURIComponent("Prezados,\n\nSolicito verificação da seguinte lista de alunos da disciplina "+s+", curso "+c+", que estão com frequência abaixo de 75%:\n\n"+p.map((e,t)=>t+1+". "+e.nome+" - "+e.total+" faltas - "+e.frequencia+"% de frequência").join("\n")+"\n\nAtenciosamente,\n"+m),a="https://mail.google.com/mail/?view=cm&fs=1&to=sepae.tb@ifpr.edu.br&su="+e+"&body="+t;window.open(a,"_blank")},h.appendChild(v);const E=document.createElement("button");E.textContent="❌ Fechar",E.style="margin-top:10px;margin-left:10px;padding:6px 10px;background:#990000;color:#fff;border:none;border-radius:5px;cursor:pointer",E.onclick=()=>h.remove(),h.appendChild(E),document.body.appendChild(h);})();
